<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart School Portal | Amit Murolia</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Hind:wght@400;500;600&display=swap');

        :root {
            --primary: #1e3a8a;
            --accent: #b91c1c;
            --gold: #facc15;
            --dark-blue: #0a192f;
        }

        body { font-family: 'Hind', sans-serif; background: #f1f5f9; margin: 0; user-select: none; overflow-x: hidden; }

        /* --- Branding Marquee --- */
        .scrolling-banner {
            background: #000; color: var(--gold); padding: 12px 0;
            font-weight: bold; font-size: 18px; border-bottom: 3px solid var(--accent);
            text-transform: uppercase; width: 100%; z-index: 10001;
        }

        /* --- Royal Dark Blue Home Screen --- */
        #login-screen {
            position: fixed; inset: 0; 
            background: radial-gradient(circle at center, #112240 0%, #0a192f 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000;
        }

        .slogan-box { color: white; text-align: center; margin-bottom: 25px; padding: 0 20px; }
        .slogan-box h1 { font-family: 'Montserrat'; font-size: 26px; margin: 0; color: var(--gold); text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .slogan-box p { font-size: 18px; color: #ccd6f6; margin-top: 8px; font-style: italic; }

        .login-card { display: flex; width: 1150px; background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 40px 100px rgba(0,0,0,0.7); }
        
        /* 3-Mode Master Guide */
        .instruction-side { flex: 1.4; padding: 35px; background: #f8fafc; border-right: 1px solid #e2e8f0; text-align: left; overflow-y: auto; max-height: 80vh; }
        .instruction-side h2 { color: var(--primary); font-family: 'Montserrat'; border-bottom: 3.5px solid var(--accent); display: inline-block; margin-bottom: 20px; font-size: 20px; }
        
        .mode-box { background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 12px; border-left: 6px solid var(--primary); box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .mode-box b { color: var(--accent); font-size: 15px; display: block; text-transform: uppercase; }
        .mode-box p { font-size: 13px; margin: 4px 0 0 0; color: #444; line-height: 1.5; }

        .auth-side { flex: 0.6; padding: 40px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #fff; }
        .pass-input { width: 100%; padding: 18px; border: 2.5px solid #e2e8f0; border-radius: 12px; font-size: 22px; text-align: center; margin-bottom: 25px; outline: none; }

        /* --- Dashboard Area --- */
        #dashboard { display: none; }
        .main-layout { display: grid; grid-template-columns: 370px 1fr; min-height: 100vh; }
        .sidebar { background: white; padding: 25px; border-right: 1px solid #e2e8f0; height: 100vh; overflow-y: auto; position: sticky; top: 0; }
        
        label { display: block; font-size: 13px; font-weight: bold; color: #64748b; margin-bottom: 5px; }
        input, textarea, select { width: 100%; padding: 10px; border: 1.2px solid #cbd5e1; border-radius: 8px; font-family: inherit; margin-bottom: 12px; font-size: 14px; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; font-family: 'Montserrat'; transition: 0.2s; }
        .btn-gen { background: var(--accent); color: white; margin-top: 5px; }
        .btn-print { background: var(--primary); color: white; margin-top: 10px; }

        /* --- PRINT SETTINGS --- */
        @media print {
            @page { size: A4 portrait; margin: 0; }
            .no-print, #login-screen { display: none !important; }
            body { background: white; margin: 0; padding: 0; }
            .page { 
                width: 210mm; height: 297mm; display: flex; flex-direction: column; align-items: center;
                page-break-after: always; overflow: hidden;
            }
            .card-frame { margin: 10mm 0 !important; border-width: 6px !important; width: 190mm !important; height: 132mm !important; }
        }

        .page { background: white; width: 210mm; height: 297mm; display: flex; flex-direction: column; align-items: center; margin: 0 auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .card-frame {
            width: 190mm; height: 132mm; border: 8px double var(--primary); padding: 20px; 
            box-sizing: border-box; position: relative; margin: 10mm 0; background: #fff;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60%; opacity: 0.08; z-index: 0; pointer-events: none; }
        
        .card-header { height: 85px; display: grid; grid-template-columns: 80px 1fr 80px; align-items: center; border-bottom: 1.5px solid #000; z-index: 1; }
        .logo-box { width: 65px; height: 65px; object-fit: contain; }
        .school-title-area { text-align: center; }
        .school-title-area h2 { margin: 0; color: var(--accent); font-size: 24px; font-weight: 800; }
        
        .card-body { flex: 1; text-align: left; z-index: 1; display: flex; flex-direction: column; justify-content: center; padding: 0 10px; }
        .invitation-heading { font-family: 'Montserrat'; color: #000; font-size: 24px; text-decoration: underline; font-weight: 800; margin-bottom: 10px; text-align: center; }
        .msg-text { font-size: 17px; color: #222; line-height: 1.5; margin-bottom: 10px; }
        
        .info-strip { 
            background: #f8fafc; padding: 12px; border: 2.5px double var(--primary); 
            display: flex; justify-content: space-around; font-weight: bold; 
            font-size: 16px; color: #000; text-align: center;
        }
        
        .card-footer { height: 65px; display: flex; flex-direction: column; justify-content: flex-end; z-index: 1; border-top: 1px solid #000; padding-top: 8px; }
        .footer-line { display: flex; justify-content: space-between; background: #000; color: white; padding: 6px 15px; border-radius: 5px; font-size: 14px; font-weight: bold; margin-bottom: 5px; }
        .vineet-box { text-align: right; font-weight: bold; font-size: 15px; color: #000; }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="login-screen">
    <div class="scrolling-banner">
        <marquee behavior="scroll" direction="left" scrollamount="11">üöÄ Developed By: AMIT MUROLIA (BCI) | ‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø, ‡§®‡§æ‡§∞‡•Ä (‡§ö‡§ø‡§°‡§º‡§æ‡§µ‡§æ) | ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§è‡§ú‡•Å‡§ï‡•á‡§∂‡§® ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ ‚ú®</marquee>
    </div>

    <div class="slogan-box">
        <h1>"‡§â‡§†‡•ã, ‡§ú‡§æ‡§ó‡•ã ‡§î‡§∞ ‡§§‡§¨ ‡§§‡§ï ‡§Æ‡§§ ‡§∞‡•Å‡§ï‡•ã ‡§ú‡§¨ ‡§§‡§ï ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§® ‡§π‡•ã ‡§ú‡§æ‡§è"</h1>
        <p>‚Äî ‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä ‡§µ‡§ø‡§µ‡•á‡§ï‡§æ‡§®‡§Ç‡§¶</p>
    </div>
    
    <div class="login-card">
        <div class="instruction-side">
            <h2>üìñ ‡§Æ‡•ã‡§° ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§ø‡§ï‡§æ (How to Use Modes)</h2>
            
            <div class="mode-box">
                <b>1. üìä ‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§¨‡§≤‡•ç‡§ï ‡§Æ‡•ã‡§° (Bulk Data)</b>
                <p>‡§™‡•Ç‡§∞‡•á ‡§∏‡•ç‡§ï‡•Ç‡§≤ ‡§Ø‡§æ ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§ï‡§æ ‡§°‡•á‡§ü‡§æ Excel ‡§∏‡•á ‡§è‡§ï ‡§∏‡§æ‡§• ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ 'Class Filter' ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§î‡§∞ 'Generate' ‡§¶‡§¨‡§æ‡§è‡§Å‡•§</p>
            </div>
            <div class="mode-box">
                <b>2. ‚úèÔ∏è ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡•ã‡§° (Manual Entry)</b>
                <p>‡§Ø‡§¶‡§ø ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§Ø‡§æ ‡§¶‡•ã ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§° ‡§Ö‡§≤‡§ó ‡§∏‡•á ‡§¨‡§®‡§æ‡§®‡•á ‡§π‡•ã‡§Ç, ‡§§‡•ã ‡§á‡§∏ ‡§Æ‡•ã‡§° ‡§ï‡•ã ‡§ö‡•Å‡§®‡•á‡§Ç ‡§î‡§∞ ‡§∏‡•Ä‡§ß‡§æ ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§ï‡§ï‡•ç‡§∑‡§æ, ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç‡•§</p>
            </div>
            <div class="mode-box">
                <b>3. üë§ ‡§Ö‡§§‡§ø‡§•‡§ø ‡§Æ‡•ã‡§° (Guest Mode)</b>
                <p>‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§Ö‡§§‡§ø‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§π‡•á‡§§‡•Å ‡§Ö‡§§‡§ø‡§•‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§î‡§∞ ‡§™‡§ø‡§§‡§æ ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§ï‡§æ ‡§ï‡•â‡§≤‡§Æ ‡§ë‡§ü‡•ã‡§Æ‡•à‡§ü‡§ø‡§ï ‡§π‡§ü ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</p>
            </div>
            <div class="mode-box">
                <b>üñ®Ô∏è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü‡§ø‡§Ç‡§ó ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó (‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂)</b>
                <p>'Generate' ‡§ï‡•á ‡§¨‡§æ‡§¶ 'Print' ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§è‡§Å‡•§ ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§µ‡§ø‡§Ç‡§°‡•ã ‡§Æ‡•á‡§Ç <b>Margins: "None"</b> ‡§ö‡•Å‡§®‡•á‡§Ç‡•§ ‡§è‡§ï A4 ‡§∂‡•Ä‡§ü ‡§™‡§∞ 2 ‡§ï‡§æ‡§∞‡•ç‡§° ‡§™‡§∞‡§´‡•á‡§ï‡•ç‡§ü ‡§∏‡•á‡§ü ‡§π‡•ã‡§Ç‡§ó‡•á‡•§</p>
            </div>
        </div>

        <div class="auth-side">
            <div style="font-size: 50px; margin-bottom: 10px;">üèõÔ∏è</div>
            <h3 style="font-family:'Montserrat'; color:var(--primary); font-size: 24px;">Admin Access</h3>
            <input type="password" id="passInp" class="pass-input" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° (Nari123)">
            <button class="btn btn-gen" style="width:100%" onclick="login()">Dashboard ‡§™‡•ç‡§∞‡§µ‡•á‡§∂</button>
            <p style="margin-top:15px; font-size:11px; color:grey; font-weight:bold;">Help: 9782336436 | Amit Murolia</p>
        </div>
    </div>
</div>

<div id="dashboard">
    <div class="scrolling-banner no-print">
        <marquee behavior="scroll" direction="left" scrollamount="11">üöÄ Developed By: AMIT MUROLIA (BCI) | ‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø, ‡§®‡§æ‡§∞‡•Ä (‡§ö‡§ø‡§°‡§º‡§æ‡§µ‡§æ) | ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§π‡•á‡§§‡•Å: 9782336436 ‚ú®</marquee>
    </div>

    <div class="main-layout">
        <div class="sidebar no-print">
            <h2 style="font-size:18px; color:var(--primary); border-bottom:1px solid #eee; padding-bottom:10px;">‚öôÔ∏è ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§™‡•à‡§®‡§≤</h2>
            <label>‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§Æ‡•ã‡§° ‡§ö‡•Å‡§®‡•á‡§Ç</label>
            <select id="mode" onchange="toggleMode()">
                <option value="bulk">üìä ‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§¨‡§≤‡•ç‡§ï ‡§°‡•á‡§ü‡§æ</option>
                <option value="manual">‚úèÔ∏è ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä (‡§õ‡§æ‡§§‡•ç‡§∞)</option>
                <option value="guest">üë§ ‡§Ö‡§§‡§ø‡§•‡§ø (Guest Mode)</option>
            </select>
            
            <div id="bulkSec">
                <label>Excel ‡§°‡•á‡§ü‡§æ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç</label>
                <textarea id="rawInput" rows="4" placeholder="Class [Tab] Name [Tab] Father Name..." oninput="updateFilters()"></textarea>
                <label>‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ (Select Class)</label>
                <select id="classFilter">
                    <option value="all">‡§∏‡§≠‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏ (Show All)</option>
                </select>
            </div>

            <div id="manualSec" style="display:none;">
                <input type="text" id="mC" placeholder="‡§ï‡•ç‡§≤‡§æ‡§∏ (Class)"><input type="text" id="mN" placeholder="‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ"><input type="text" id="mF" placeholder="‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ">
            </div>
            <div id="guestSec" style="display:none;">
                <input type="text" id="gN" placeholder="‡§Ö‡§§‡§ø‡§•‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç">
            </div>

            <label>‡§≤‡•ã‡§ó‡•ã / ‡§µ‡§æ‡§ü‡§∞‡§Æ‡§æ‡§∞‡•ç‡§ï</label>
            <div style="display:flex; gap:5px;"><input type="file" id="lImg" title="Left"><input type="file" id="rImg" title="Right"></div>
            <input type="file" id="bgImg" style="margin-top:5px;">
            
            <hr style="margin:15px 0; border:0; border-top:1px solid #eee;">
            <label>‡§∏‡•ç‡§ï‡•Ç‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ</label><input type="text" id="sName" value="‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø, ‡§®‡§æ‡§∞‡•Ä (‡§ö‡§ø‡§°‡§º‡§æ‡§µ‡§æ)">
            <label>‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§π‡•á‡§°‡§ø‡§Ç‡§ó (Edit Heading)</label><input type="text" id="hText" value="‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£: ‡§®‡§ø‡§™‡•Å‡§£ ‡§Æ‡•á‡§≤‡§æ ‡§è‡§µ‡§Ç ‡§Æ‡•á‡§ó‡§æ PTM">
            <label>‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§∏‡§Ç‡§¶‡•á‡§∂</label><textarea id="mText" rows="2">‡§∏‡§æ‡§¶‡§∞ ‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞‡•§ ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∂‡•à‡§ï‡•ç‡§∑‡§£‡§ø‡§ï ‡§ï‡•å‡§∂‡§≤ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§π‡•á‡§§‡•Å ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§Ü‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§π‡•à‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§ó‡§∞‡§ø‡§Æ‡§æ‡§Æ‡§Ø‡•Ä ‡§â‡§™‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à‡•§</textarea>
            <label>‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§è‡§µ‡§Ç ‡§∏‡§Æ‡§Ø</label><input type="text" id="eText" value="üìÖ 23 ‡§¶‡§ø‡§∏‡§Æ‡•ç‡§¨‡§∞ 2025 | ‚è∞ 11:00 AM">
            <label>‡§Ü‡§Ø‡•ã‡§ú‡§® ‡§∏‡•ç‡§•‡§≤ (Venue)</label><input type="text" id="vPlace" value="üìç ‡§∏‡•ç‡§•‡§æ‡§®: ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§∏‡§≠‡§æ ‡§≠‡§µ‡§®">
            <label>‡§µ‡§ø‡§®‡•Ä‡§§</label><input type="text" id="vText" value="‡§™‡•ç‡§∞‡§ß‡§æ‡§®‡§æ‡§ö‡§æ‡§∞‡•ç‡§Ø ‡§è‡§µ‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§§ ‡§∏‡•ç‡§ü‡§æ‡§´">
            
            <button class="btn btn-gen" onclick="render()">‚úÖ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
            <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç</button>
        </div>
        <div class="preview-pane" id="outArea"></div>
    </div>
</div>

<script>
    let leftLogo = "", rightLogo = "", watermark = "";
    function login() { if(document.getElementById('passInp').value === "Nari123") { document.getElementById('login-screen').style.display='none'; document.getElementById('dashboard').style.display='block'; } else alert("‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°!"); }
    
    document.getElementById('lImg').onchange = (e) => { const r = new FileReader(); r.onload=()=>leftLogo=r.result; r.readAsDataURL(e.target.files[0]); };
    document.getElementById('rImg').onchange = (e) => { const r = new FileReader(); r.onload=()=>rightLogo=r.result; r.readAsDataURL(e.target.files[0]); };
    document.getElementById('bgImg').onchange = (e) => { const r = new FileReader(); r.onload=()=>watermark=r.result; r.readAsDataURL(e.target.files[0]); };
    
    function toggleMode() { let m=document.getElementById('mode').value; document.getElementById('bulkSec').style.display=(m==='bulk')?'block':'none'; document.getElementById('manualSec').style.display=(m==='manual')?'block':'none'; document.getElementById('guestSec').style.display=(m==='guest')?'block':'none'; }

    function updateFilters() {
        const input = document.getElementById('rawInput').value.trim();
        const filter = document.getElementById('classFilter');
        const classes = new Set();
        input.split('\n').forEach(line => { const d = line.split(/\t/); if(d[0]) classes.add(d[0].trim()); });
        filter.innerHTML = '<option value="all">‡§∏‡§≠‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏ (Show All)</option>';
        Array.from(classes).sort().forEach(c => { const opt = document.createElement('option'); opt.value = c; opt.innerText = "Class: " + c; filter.appendChild(opt); });
    }

    function render() {
        const area = document.getElementById('outArea'); area.innerHTML = '';
        const m = document.getElementById('mode').value;
        const school = document.getElementById('sName').value;
        const hText = document.getElementById('hText').value;
        const mText = document.getElementById('mText').value;
        const event = document.getElementById('eText').value;
        const venue = document.getElementById('vPlace').value;
        const vineet = document.getElementById('vText').value;
        const selectedClass = document.getElementById('classFilter').value;
        let cards = [];

        const build = (c1, c2, c3, type) => {
            let detail = (type === 'guest') ? `‡§Ö‡§§‡§ø‡§•‡§ø: ${c1}` : `<span>‡§ï‡§ï‡•ç‡§∑‡§æ: ${c1}</span> <span>‡§õ‡§æ‡§§‡•ç‡§∞: ${c2}</span> <span>‡§™‡§ø‡§§‡§æ: ‡§∂‡•ç‡§∞‡•Ä ${c3}</span>`;
            return `
            <div class="card-frame">
                ${watermark ? `<img src="${watermark}" class="watermark">` : ''}
                <div class="card-content">
                    <div class="card-header">
                        ${leftLogo ? `<img src="${leftLogo}" class="logo-box">` : '<div></div>'}
                        <div class="school-title-area">
                            <small>‡•• ‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§µ‡§ø‡§≠‡§æ‡§ó ‡••</small>
                            <h2>${school}</h2>
                            <div style="border-bottom:2px solid #000; width:85%; margin:3px auto;"></div>
                        </div>
                        ${rightLogo ? `<img src="${rightLogo}" class="logo-box">` : '<div></div>'}
                    </div>
                    <div class="card-body">
                        <div class="invitation-heading">${hText}</div>
                        <p class="msg-text"><b>‡§Ü‡§¶‡§∞‡§£‡•Ä‡§Ø ‡§Æ‡§π‡§æ‡§®‡•Å‡§≠‡§æ‡§µ,</b><br>${mText}</p>
                        <div class="info-strip">${detail}</div>
                    </div>
                    <div class="card-footer">
                        <div class="footer-line"><span>${event}</span><span>${venue}</span></div>
                        <div class="vineet-box">‡§µ‡§ø‡§®‡•Ä‡§§: ${vineet}</div>
                    </div>
                </div>
            </div>`;
        };

        if(m==='bulk') {
            document.getElementById('rawInput').value.trim().split('\n').forEach(line => {
                let d = line.split(/\t/);
                if(d[1]) {
                    if(selectedClass === 'all' || d[0].trim() === selectedClass) {
                        cards.push(build(d[0], d[1], d[2], 'student'));
                    }
                }
            });
        } else if(m==='manual') {
            cards.push(build(document.getElementById('mC').value, document.getElementById('mN').value, document.getElementById('mF').value, 'student'));
        } else {
            cards.push(build(document.getElementById('gN').value, "", "", 'guest'));
        }

        for (let i = 0; i < cards.length; i += 2) {
            let p = document.createElement('div'); p.className = 'page';
            p.innerHTML = cards[i] + (cards[i+1] ? cards[i+1] : "");
            area.appendChild(p);
        }
    }
</script>
</body>
</html>
