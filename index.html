<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart School Portal | Amit Murolia</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Hind:wght@400;500;600&display=swap');
        
        :root { --primary: #1e3a8a; --accent: #b91c1c; --gold: #facc15; --dark-blue: #0a192f; }
        
        body { font-family: 'Hind', sans-serif; background: #f1f5f9; margin: 0; user-select: none; }

        /* --- Home & Login --- */
        #login-screen { position: fixed; inset: 0; background: radial-gradient(circle at center, #112240 0%, #0a192f 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; }
        .scrolling-banner { background: #000; color: var(--gold); padding: 12px 0; font-weight: bold; width: 100%; border-bottom: 3px solid var(--accent); position: fixed; top: 0; text-align:center; }
        .slogan-box { color: white; text-align: center; margin-bottom: 25px; padding: 0 20px; margin-top: 60px; }
        .slogan-box h1 { font-family: 'Montserrat'; font-size: 26px; color: var(--gold); margin: 0; }
        .login-card { display: flex; width: 1050px; background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 40px 100px rgba(0,0,0,0.7); }
        .instruction-side { flex: 1.3; padding: 30px; background: #f8fafc; border-right: 1px solid #e2e8f0; overflow-y: auto; max-height: 75vh; }
        .instruction-side h2 { color: var(--primary); border-bottom: 3px solid var(--accent); display: inline-block; margin-bottom: 15px; }
        .step-box { background: #fff; padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 5px solid var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .step-box b { color: var(--accent); display: block; margin-bottom: 3px; font-size: 15px; }
        .step-box p { font-size: 13.5px; margin: 0; color: #444; line-height: 1.5; }
        .auth-side { flex: 0.7; padding: 40px; display: flex; flex-direction: column; justify-content: center; align-items: center; }

        /* --- Dashboard --- */
        #dashboard { display: none; }
        .main-layout { display: grid; grid-template-columns: 370px 1fr; min-height: 100vh; }
        .sidebar { background: white; padding: 25px; border-right: 1px solid #e2e8f0; height: 100vh; overflow-y: auto; position: sticky; top: 0; }
        label { display: block; font-size: 13px; font-weight: bold; color: #64748b; margin-top: 10px; }
        input, textarea, select { width: 100%; padding: 10px; border: 1.2px solid #cbd5e1; border-radius: 8px; margin-bottom: 5px; box-sizing: border-box; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .btn-gen { background: var(--accent); color: white; }
        .btn-print { background: var(--primary); color: white; margin-top: 10px; }

        /* --- Card Layout --- */
        .page { background: white; width: 210mm; min-height: 296mm; display: flex; flex-direction: column; align-items: center; margin: 0 auto; padding: 5mm 0; box-sizing: border-box; }
        .card-unit { width: 190mm; margin-bottom: 5mm; page-break-inside: avoid; display: flex; flex-direction: column; align-items: center; }
        .card-frame { width: 190mm; height: 128mm; border: 8px double var(--primary); padding: 15px; position: relative; background: #fff; display: flex; flex-direction: column; justify-content: space-between; box-sizing: border-box; overflow: hidden; }
        
        .watermark-img { position: absolute; top: 55%; left: 50%; transform: translate(-50%, -50%); width: 55%; opacity: 0.12; pointer-events: none; z-index: 0; }
        
        .card-header { height: 85px; display: flex; align-items: center; justify-content: space-between; border-bottom: 2px solid #000; z-index: 1; position: relative; }
        .logo-container { width: 75px; height: 75px; display: flex; align-items: center; justify-content: center; }
        .logo-box { max-width: 100%; max-height: 100%; object-fit: contain; }
        .school-title-area { flex: 1; text-align: center; }
        .school-title-area h2 { margin: 0; color: var(--accent); font-size: 22px; font-weight: 800; line-height: 1.1; }
        .school-title-area small { display: block; font-weight: bold; color: #000; margin-bottom: 2px; }

        .card-body { flex: 1; text-align: center; z-index: 1; display: flex; flex-direction: column; justify-content: center; padding: 5px; }
        .invitation-heading { font-size: 24px; text-decoration: underline; font-weight: 800; margin-bottom: 8px; color: #000; }
        .msg-text { font-size: 17px; line-height: 1.5; text-align: justify; color: #222; margin-bottom: 12px; }
        
        .info-strip { background: #f1f5f9; padding: 10px; border: 2px solid var(--primary); display: flex; justify-content: space-around; font-weight: bold; font-size: 15px; }
        .card-footer { border-top: 1px solid #000; padding-top: 5px; z-index: 1; }
        .footer-line { display: flex; justify-content: space-between; background: #000; color: white; padding: 6px 12px; border-radius: 5px; font-size: 13px; }
        
        .card-actions { display: flex; gap: 10px; justify-content: center; margin-top: 5px; margin-bottom: 15px; }
        .btn-wa { background: #25d366; color: white; border: none; padding: 8px 18px; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: bold; }
        .btn-dl { background: #1e3a8a; color: white; border: none; padding: 8px 18px; border-radius: 5px; cursor: pointer; font-size: 12px; font-weight: bold; }

        @media print { .no-print, #login-screen, .card-actions { display: none !important; } }
    </style>
</head>
<body oncontextmenu="return false;">

<div id="login-screen">
    <div class="scrolling-banner">
        <marquee behavior="scroll" direction="left" scrollamount="11">üöÄ Developed By: AMIT MUROLIA (BCI) | ‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø, ‡§®‡§æ‡§∞‡•Ä (‡§ö‡§ø‡§°‡§º‡§æ‡§µ‡§æ) ‚ú®</marquee>
    </div>
    <div class="slogan-box">
        <h1>"‡§â‡§†‡•ã, ‡§ú‡§æ‡§ó‡•ã ‡§î‡§∞ ‡§§‡§¨ ‡§§‡§ï ‡§Æ‡§§ ‡§∞‡•Å‡§ï‡•ã ‡§ú‡§¨ ‡§§‡§ï ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§® ‡§π‡•ã ‡§ú‡§æ‡§è"</h1>
        <p>‚Äî ‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä ‡§µ‡§ø‡§µ‡•á‡§ï‡§æ‡§®‡§Ç‡§¶</p>
    </div>
    <div class="login-card">
        <div class="instruction-side">
            <h2>‚ú® ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤ - ‡§´‡•Ä‡§ö‡§∞‡•ç‡§∏</h2>
            <div class="step-box"><b>üìä ‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§¨‡§≤‡•ç‡§ï ‡§Æ‡•à‡§®‡•á‡§ú‡§Æ‡•á‡§Ç‡§ü:</b><p>Excel ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•â‡§™‡•Ä-‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ø‡§π‡§æ‡§Å ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡§®‡§æ ‡§™‡•Ç‡§∞‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á <b>‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï (Optional)</b> ‡§π‡•à‡•§</p></div>
            <div class="step-box"><b>üì± ‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§ë‡§ü‡•ã-‡§∏‡§ø‡§Ç‡§ï:</b><p>'WhatsApp' ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§§‡•á ‡§π‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•Ä ‡§∏‡§æ‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä (‡§∏‡•ç‡§ï‡•Ç‡§≤, ‡§õ‡§æ‡§§‡•ç‡§∞, ‡§§‡§æ‡§∞‡•Ä‡§ñ, ‡§∏‡•ç‡§•‡§æ‡§®) ‡§ë‡§ü‡•ã‡§Æ‡•à‡§ü‡§ø‡§ï ‡§Æ‡•à‡§∏‡•á‡§ú ‡§Æ‡•á‡§Ç ‡§ü‡§æ‡§á‡§™ ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§</p></div>
            <div class="step-box"><b>üñºÔ∏è ‡§ü‡•ç‡§∞‡§ø‡§™‡§≤ ‡§≤‡•ã‡§ó‡•ã ‡§è‡§µ‡§Ç ‡§µ‡•â‡§ü‡§∞‡§Æ‡§æ‡§∞‡•ç‡§ï:</b><p>‡§¶‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§¨‡§æ‡§è‡§Ç ‡§¶‡•ã ‡§Ö‡§≤‡§ó ‡§≤‡•ã‡§ó‡•ã ‡§≤‡§ó‡§æ‡§Ø‡•á‡§Ç ‡§î‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•á ‡§™‡•Ä‡§õ‡•á ‡§µ‡•â‡§ü‡§∞‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§</p></div>
            <div class="step-box"><b>üíæ ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§´‡•ã‡§ü‡•ã ‡§∏‡•á‡§µ:</b><p>'Save Photo' ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§∏‡•á ‡§ï‡§æ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§á‡§Æ‡•á‡§ú (.png) ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§ñ‡•á‡§Ç‡•§</p></div>
            <div class="step-box"><b>üñ®Ô∏è ‡§™‡§∞‡§´‡•á‡§ï‡•ç‡§ü ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü‡§ø‡§Ç‡§ó:</b><p>‡§è‡§ï A4 ‡§™‡•á‡§ú ‡§™‡§∞ ‡§†‡•Ä‡§ï 2 ‡§ï‡§æ‡§∞‡•ç‡§° ‡§∏‡•á‡§ü ‡§π‡•à‡§Ç‡•§ ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§∏‡§Æ‡§Ø 'Margins: None' ‡§∞‡§ñ‡•á‡§Ç‡•§</p></div>
        </div>
        <div class="auth-side">
            <div style="font-size: 50px;">üèõÔ∏è</div>
            <h3 style="color:var(--primary)">‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®</h3>
            <input type="password" id="passInp" placeholder="Nari123" style="text-align:center; font-size:22px; width:80%; border:2px solid #ddd; padding:10px; border-radius:10px;">
            <button class="btn btn-gen" style="width:85%; margin-top:15px;" onclick="login()">‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§ï‡§∞‡•á‡§Ç</button>
            <p style="font-size:12px; color:gray; margin-top:20px; font-weight:bold;">‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï: 9782336436 | Amit Murolia</p>
        </div>
    </div>
</div>

<div id="dashboard">
    <div class="main-layout">
        <div class="sidebar no-print">
            <h3 style="color:var(--primary); border-bottom:1px solid #eee;">‚öôÔ∏è ‡§ï‡§æ‡§∞‡•ç‡§° ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</h3>
            <label>‡§Æ‡•ã‡§° ‡§ö‡•Å‡§®‡•á‡§Ç</label>
            <select id="mode" onchange="toggleMode()">
                <option value="bulk">üìä ‡§è‡§ï‡•ç‡§∏‡•á‡§≤ ‡§¨‡§≤‡•ç‡§ï ‡§°‡•á‡§ü‡§æ</option>
                <option value="manual">‚úèÔ∏è ‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§õ‡§æ‡§§‡•ç‡§∞</option>
                <option value="guest">üë§ ‡§Ö‡§§‡§ø‡§•‡§ø (Guest)</option>
            </select>
            <div id="bulkSec">
                <textarea id="rawInput" rows="3" placeholder="Class [Tab] Name [Tab] Father [Tab] Mobile" oninput="updateFilters()"></textarea>
                <select id="classFilter"><option value="all">‡§∏‡§≠‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏</option></select>
            </div>
            <div id="manualSec" style="display:none;"><input type="text" id="mC" placeholder="‡§ï‡•ç‡§≤‡§æ‡§∏"><input type="text" id="mN" placeholder="‡§®‡§æ‡§Æ"><input type="text" id="mF" placeholder="‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ"><input type="text" id="mM" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤"></div>
            <div id="guestSec" style="display:none;"><input type="text" id="gN" placeholder="‡§Ö‡§§‡§ø‡§•‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ"><input type="text" id="gM" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤"></div>
            <label>‡§∏‡•ç‡§ï‡•Ç‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ</label><input type="text" id="sName" value="‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ‡§ø‡§ï ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø, ‡§®‡§æ‡§∞‡•Ä (‡§ö‡§ø‡§°‡§º‡§æ‡§µ‡§æ)">
            <label>‡§ï‡§æ‡§∞‡•ç‡§° ‡§π‡•á‡§°‡§ø‡§Ç‡§ó</label><input type="text" id="hText" value="‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£: ‡§®‡§ø‡§™‡•Å‡§£ ‡§Æ‡•á‡§≤‡§æ ‡§è‡§µ‡§Ç ‡§Æ‡•á‡§ó‡§æ PTM">
            <label>‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∏‡§Ç‡§¶‡•á‡§∂</label><textarea id="mText" rows="3">‡§∏‡§æ‡§¶‡§∞ ‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞‡•§ ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∂‡•à‡§ï‡•ç‡§∑‡§£‡§ø‡§ï ‡§ï‡•å‡§∂‡§≤ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§π‡•á‡§§‡•Å ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§Ü‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§π‡•à‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§ó‡§∞‡§ø‡§Æ‡§æ‡§Æ‡§Ø‡•Ä ‡§â‡§™‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à‡•§</textarea>
            <label>‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§è‡§µ‡§Ç ‡§∏‡§Æ‡§Ø</label><input type="text" id="eText" value="üìÖ 23 ‡§ú‡§®‡§µ‡§∞‡•Ä 2026 | ‚è∞ 11:00 AM">
            <label>‡§∏‡•ç‡§•‡§æ‡§®</label><input type="text" id="vPlace" value="üìç ‡§∏‡•ç‡§•‡§æ‡§®: ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§∏‡§≠‡§æ ‡§≠‡§µ‡§®">
            <label>‡§µ‡§ø‡§®‡•Ä‡§§</label><input type="text" id="vText" value="‡§™‡•ç‡§∞‡§ß‡§æ‡§®‡§æ‡§ö‡§æ‡§∞‡•ç‡§Ø ‡§è‡§µ‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§§ ‡§∏‡•ç‡§ü‡§æ‡§´">
            <label>‡§≤‡•ã‡§ó‡•ã (‡§¨‡§æ‡§Ø‡§æ‡§Ç / ‡§¶‡§æ‡§Ø‡§æ‡§Ç)</label>
            <div style="display:flex; gap:5px;"><input type="file" id="lImg" title="Left"><input type="file" id="rImg" title="Right"></div>
            <label>‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° ‡§µ‡•â‡§ü‡§∞‡§Æ‡§æ‡§∞‡•ç‡§ï</label><input type="file" id="bgImg">
            <button class="btn btn-gen" onclick="render()">‚úÖ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
            <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç</button>
        </div>
        <div class="preview-pane" id="outArea"></div>
    </div>
</div>

<script>
    let leftLogo = "", rightLogo = "", watermark = "";
    function login() { if(document.getElementById('passInp').value === "Nari123") { document.getElementById('login-screen').style.display='none'; document.getElementById('dashboard').style.display='block'; } else alert("‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ó‡§≤‡§§ ‡§π‡•à!"); }
    
    document.getElementById('lImg').onchange = (e) => { const r = new FileReader(); r.onload=()=>leftLogo=r.result; r.readAsDataURL(e.target.files[0]); };
    document.getElementById('rImg').onchange = (e) => { const r = new FileReader(); r.onload=()=>rightLogo=r.result; r.readAsDataURL(e.target.files[0]); };
    document.getElementById('bgImg').onchange = (e) => { const r = new FileReader(); r.onload=()=>watermark=r.result; r.readAsDataURL(e.target.files[0]); };

    function toggleMode() {
        let m = document.getElementById('mode').value;
        document.getElementById('bulkSec').style.display = (m==='bulk'?'block':'none');
        document.getElementById('manualSec').style.display = (m==='manual'?'block':'none');
        document.getElementById('guestSec').style.display = (m==='guest'?'block':'none');
    }

    function updateFilters() {
        const input = document.getElementById('rawInput').value.trim();
        const filter = document.getElementById('classFilter');
        const classes = new Set();
        input.split('\n').forEach(line => { const d = line.split(/\t/); if(d[0]) classes.add(d[0].trim()); });
        filter.innerHTML = '<option value="all">‡§∏‡§≠‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏</option>';
        Array.from(classes).sort().forEach(c => { const opt = document.createElement('option'); opt.value = c; opt.innerText = "‡§ï‡§ï‡•ç‡§∑‡§æ: " + c; filter.appendChild(opt); });
    }

    function saveCard(btn) {
        const cardFrame = btn.parentElement.previousElementSibling;
        html2canvas(cardFrame, { scale: 3 }).then(canvas => {
            const link = document.createElement('a');
            link.download = 'Invitation.png';
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    function sendWA(person, father, className, mobile) {
        const s = document.getElementById('sName').value, h = document.getElementById('hText').value, m = document.getElementById('mText').value;
        const e = document.getElementById('eText').value, v = document.getElementById('vPlace').value, vt = document.getElementById('vText').value;
        let d = father ? `\n*‡§õ‡§æ‡§§‡•ç‡§∞:* ${person}\n*‡§™‡§ø‡§§‡§æ:* ‡§∂‡•ç‡§∞‡•Ä ${father}\n*‡§ï‡§ï‡•ç‡§∑‡§æ:* ${className}` : `\n*‡§Ö‡§§‡§ø‡§•‡§ø:* ${person}`;
        const final = `*${s}*\n\n*${h}*\n\n‡§Ü‡§¶‡§∞‡§£‡•Ä‡§Ø ‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï,\n${m}\n${d}\n\n${e}\n${v}\n\n*‡§µ‡§ø‡§®‡•Ä‡§§:* ${vt}`;
        window.open(`https://wa.me/${mobile ? '91'+mobile : ''}?text=${encodeURIComponent(final)}`, '_blank');
    }

    function render() {
        const area = document.getElementById('outArea'); area.innerHTML = '';
        const m = document.getElementById('mode').value, sName = document.getElementById('sName').value, hText = document.getElementById('hText').value;
        const mText = document.getElementById('mText').value, eText = document.getElementById('eText').value, vPlace = document.getElementById('vPlace').value;
        const vText = document.getElementById('vText').value, filter = document.getElementById('classFilter').value;
        
        let list = [];
        if(m==='bulk') {
            document.getElementById('rawInput').value.trim().split('\n').forEach(line => {
                let d = line.split(/\t/);
                if(d[1] && (filter === 'all' || d[0].trim() === filter)) list.push({ c1: d[0], c2: d[1], c3: d[2], mob: d[3] || "", type: 'student' });
            });
        } else if(m==='manual') {
            list.push({ c1: document.getElementById('mC').value, c2: document.getElementById('mN').value, c3: document.getElementById('mF').value, mob: document.getElementById('mM').value, type: 'student' });
        } else {
            list.push({ c1: document.getElementById('gN').value, c2: "", c3: "", mob: document.getElementById('gM').value, type: 'guest' });
        }

        const build = (d) => {
            let info = (d.type==='guest') ? `‡§Ö‡§§‡§ø‡§•‡§ø: ${d.c1}` : `<span>‡§ï‡§ï‡•ç‡§∑‡§æ: ${d.c1}</span> <span>‡§õ‡§æ‡§§‡•ç‡§∞: ${d.c2}</span> <span>‡§™‡§ø‡§§‡§æ: ‡§∂‡•ç‡§∞‡•Ä ${d.c3}</span>`;
            return `
            <div class="card-unit">
                <div class="card-frame">
                    ${watermark ? `<img src="${watermark}" class="watermark-img">` : ''}
                    <div class="card-header">
                        <div class="logo-container">${leftLogo ? `<img src="${leftLogo}" class="logo-box">` : ''}</div>
                        <div class="school-title-area">
                            <small>‡•• ‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§µ‡§ø‡§≠‡§æ‡§ó ‡••</small>
                            <h2>${sName}</h2>
                            <div style="border-bottom:2px solid #000; width:80%; margin:4px auto;"></div>
                        </div>
                        <div class="logo-container">${rightLogo ? `<img src="${rightLogo}" class="logo-box">` : ''}</div>
                    </div>
                    <div class="card-body">
                        <div class="invitation-heading">${hText}</div>
                        <p class="msg-text"><b>‡§Ü‡§¶‡§∞‡§£‡•Ä‡§Ø ‡§Æ‡§π‡§æ‡§®‡•Å‡§≠‡§æ‡§µ,</b><br>${mText}</p>
                        <div class="info-strip">${info}</div>
                    </div>
                    <div class="card-footer">
                        <div class="footer-line"><span>${eText}</span><span>${vPlace}</span></div>
                        <div style="text-align:right; font-weight:bold; margin-top:3px; font-size:14px;">‡§µ‡§ø‡§®‡•Ä‡§§: ${vText}</div>
                    </div>
                </div>
                <div class="card-actions no-print">
                    <button class="btn-dl" onclick="saveCard(this)">üíæ Save Photo</button>
                    <button class="btn-wa" onclick="sendWA('${d.c2 || d.c1}', '${d.c3}', '${d.c1}', '${d.mob}')">üì± WhatsApp</button>
                </div>
            </div>`;
        };

        for (let i = 0; i < list.length; i += 2) {
            let p = document.createElement('div'); p.className = 'page';
            p.innerHTML = build(list[i]) + (list[i+1] ? build(list[i+1]) : "");
            area.appendChild(p);
        }
    }
</script>
</body>
</html>
